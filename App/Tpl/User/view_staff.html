<include file="Public:header" />
<link type="text/css" href="__PUBLIC__/css/dynamic.css" rel="stylesheet"/>
<style>
	.screenshot{
		width:60px;
		height:60px;
		background-color:red;
		float:left;
		border:1px solid #ccc;
		border-radius:5px;
		margin:10px 10px;
	}
</style>
<div class="container">
	<!-- Docs nav ================================================== -->
	<div class="page-header">
		<h4>{:L('USER_VIEW')}</h4>
	</div>
	<div class="row">
		<div class="span12">
			<include file="Public:alert" />
			<ul class="nav nav-tabs">
				<li class="active"><a href="#tab1" data-toggle="tab">{:L('BASIC_INFO')}</a></li>
				<!--<li><a href="#tab2" data-toggle="tab">{:L('USER_INFO_NOTE')}({$user['log_count']})</a></li>-->
				<li><a href="#tab3" data-toggle="tab">{:L('RELATED_ATTACHMENT')}({$staff['file_count']})</a></li>
			</ul>
			<div class="tab-content" style="overflow: hidden">
				<div class="tab-pane active" id="tab1">
					<table class="table" width="95%" border="0" cellspacing="1" cellpadding="0">
						<thead>
							<tr> 
								<td <if condition="C('ismobile') eq 1">colspan="2"<else />colspan="4"</if>>
									<p style="font-size: 14px;">
										<!--<a href="javascript:void(0);" class="add_log">{:L('ADD_USER_INFO_NOTE')}</a> |-->
										<a href="javascript:void(0);" class="add_file">{:L('ADD_FILE')}</a> |
										<a href="{:U('user/edit_staff','id=' . $staff['id'])}">{:L('EDIT')}</a> |
										<a href="javascript:void(0)" onclick="javascript:history.go(-1)">{:L('RETURN')}</a>
									</p>
								</td>
							</tr>
						</thead>
						<tbody>
							<tr>
								<th colspan="6">{:L('BASIC_INFO')}</th>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('USER_NAME')}:</td><td width="18%">{$staff.name}</b></td>
								<td class="tdleft" width="8%">{:L('SEX')}:</td><td width="18%"><if condition="$staff['sex'] eq 1">{:L('MALE')}<elseif condition="$staff['sex'] eq 2"/>{:L('FEMALE')}<elseif condition="$staff['sex'] eq 3"/>{:L('PRIVARY')}<else/>{:L('UNKNOW')}</if></td>
								<td  class="tdleft" width="8%">{:L('NATIVE_PLACE')}:</td><td width="18%">{$staff.native_place}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('ADDRESS')} :</td><td>{$staff.address}</td>
								<td class="tdleft" width="8%">{:L('ID_NUMBER')}:</td><td>{$staff.id_number}</td>
								<td class="tdleft" width="8%">{:L('BIRTHDAY')}:</td><td><if condition="$staff.date_leave eq '0000-00-00 00:00:00'">未知<else/>{$staff.birthday|strtotime|date="Y年m月d日",###}</if></td>
							</tr>
							<tr>
								<td  class="tdleft" width="8%">{:L('MARITAL_STATUS')}:</td>
								<td width="18%"><if condition="$staff['marital_status'] eq 1">{:L('MARRIED')}</if><if condition="$staff['marital_status'] eq 2">{:L('UNMARRIED')}</if>
									<if condition="$staff['marital_status'] eq 3">{:L('PRIVARY')}</if></td>
								<td  class="tdleft" width="8%">{:L('CURRENT_POSITION')}</td><td width="18%">{$staff['department']}-{$staff['position']}</td>
								<td class="tdleft" width="8%">{:L('SALARY')}:</td><td width="18%">{$staff.salary}</td>
							</tr>
							<tr>
								<td  class="tdleft" width="8%">{:L('PROBATION_DATE')}:</td><td width="18%"><if condition="$staff.date_leave eq '0000-00-00 00:00:00'">未知<else/>{$staff.probation_date|strtotime|date="Y年m月d日",###}</if></td>
								<td class="tdleft" width="8%">{:L('DATE_BOARD')}:</td><td width="18%">{$staff.date_board|strtotime|date="Y年m月d日",###}</td>
								<td  class="tdleft" width="8%">{:L('DATE_LEAVE')}:</td><td width="18%"><if condition="$staff.date_leave eq '0000-00-00 00:00:00'">未知<else/>{$staff.date_leave|strtotime|date="Y年m月d日",###}</if></td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('FINGERPRINT1')}:</td><td width="18%">{$staff.fingerprint1}</td>
								<td  class="tdleft" width="8%">{:L('FINGERPRINT2')}:</td><td width="18%">{$staff.fingerprint2}</td>
								<td class="tdleft" width="8%">{:L('DIMISSION')}:</td><td width="18%"><if condition="$staff['dimisson'] eq 1">{:L('ON_JOB')}<else/>{:L('dismission')}</if></td>
							</tr>
							<tr>
								<td  class="tdleft" width="8%">{:L('GRADUATE_INSTITUTIONS')}:</td><td width="18%">{$staff.graduate_institutions}</td>
								<td class="tdleft" width="8%">{:L('EDUCATION')}:</td><td width="18%">{$staff.education}</td>
								<td  class="tdleft" width="8%">{:L('PERSONAL_CALL')}:</td><td width="18%">{$staff.personal_call}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('PERSONAL_QQ')}:</td><td width="18%">{$staff.personal_qq}</td>
								<td  class="tdleft" width="8%">{:L('PERSONAL_WEIXIN')}:</td><td width="18%">{$staff.personal_weixin}</td>
								<td class="tdleft"  width="8%">{:L('EMAIL')}:</td><td><a  width="18%" href="mailto:{$staff.personal_email}">{$staff.personal_email}</a></td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('TELPHONE')}:</td><td width="18%"><a href="tel:{$staff.telephone}">{$staff.telephone}</a></td>
								<td class="tdleft" width="8%">公司微信:</td><td width="18%">{$staff.weixinid}</td>
								<td  class="tdleft" width="8%">{:L('COMPANY_QQ')}:</td><td width="18%">{$staff.company_qq}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">服务密码:</td><td width="18%">{$staff.service_password}</td>
								<td class="tdleft" width="8%">登录密码:</td><td width="18%">{$staff.weixin_password}</td>
								<td class="tdleft" width="8%">登录密码:</td><td width="18%">{$staff.qq_password}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('FATHER_NAME')}:</td><td width="18%">{$staff.father_name}</td>
								<td  class="tdleft" width="8%">{:L('MOTHER_NAME')}:</td><td width="18%">{$staff.mother_name}</td>
								<td  class="tdleft" width="8%">上班时间:</td><td width="18%">{$staff.office_hours}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('FATHER_PHONE')}:</td><td width="18%"><a href="tel:{$staff.father_phone}">{$staff.father_phone}</a></td>
								<td  class="tdleft" width="8%">{:L('MOTHER_PHONE')}:</td><td width="18%"><a href="tel:{$staff.mother_phone}">{$staff.mother_phone}</a></td>
								<td  class="tdleft" width="8%">休息时间:</td><td width="18%">{$staff.intermission}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">{:L('EMERGENCY_CONTACT_NAME')}:</td><td width="18%">{$staff.emergency_contact_name}</td>
								<td  class="tdleft" width="8%">{:L('EMERGENCY_CONTACT_PHONE')}:</td><td width="18%"><a href="tel:{$staff.emergency_contact_phone}">{$staff.emergency_contact_phone}</a></td>
								<td class="tdleft" width="8%">{:L('EMERGENCY_CONTACT')}:</td><td width="18%">{$staff.emergency_contact}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">银行账户:</td><td width="18%">{$staff.bank_account}</td>
								<td  class="tdleft" width="8%">户名:</td><td width="18%">{$staff.bank_username}</td>
								<td  class="tdleft" width="8%">开户行:</td><td width="18%">{$staff.opening_bank}</td>
							</tr>
							<tr>
								<td class="tdleft" width="8%">员工信息备注:</td><td colspan="5">{$staff.remark}</td>
							</tr>


						</tbody>
					</table>
				</div>
				<!--<div class="tab-pane" id="tab2">
					<table class="table">
						<if condition="$user.log eq null">
							<tr>
								<td>{:L('EMPTY_DATA')} </td>
							</tr>
						<else /> 
							<tr>
								<td>&nbsp;</td>
								<td>{:L('TITLE')}</td>
								<td>{:L('CONTENT')}</td>
								<td>{:L('CREATOR_ROLE')}</td>
								<td>{:L('CREATE_TIME')}</td>
							</tr>
							<volist name="user.log" id="vo">
								<tr>
									<td><a href="{:U('log/log_delete','id=' . $vo['log_id'] . '&r=RLogProduct')}">{:L('DELETE')}</a> &nbsp;<a href="{:U('log/view','id=' . $vo['log_id'])}" class="edit_log">{:L('VIEW')}</a></td>
									<td>
										{$vo.subject}
									</td>
									<td>
										<if condition="$vo.content neq null">{$vo.content|substr=0,60}……</if>
									</td>
									<td>
										<notempty name="vo.owner.user_name">{$vo.owner.user_name} [{$vo.owner.department_name}-{$vo.owner.role_name}]</notempty>
									</td>
									<td>
										<notempty name="vo.create_date">{$vo.create_date|date="Y-m-d  g:i:s a",###}</notempty>
									</td>
								</tr>
							</volist>
						</if>
						<tr>
							<td colspan="5">
								<a href="javascript:void(0);" class="add_log">{:L('ADD')}</a>
							</td>
						</tr>
					</table>
				</div>-->
				<div class="tab-pane" id="tab3">
					<table class="table">
						<if condition="$staff.file eq null">
							<tr>
								<td>{:L('EMPTY_DATA')} </td>
							</tr>
						<else /> 
							<tr>
								<td>&nbsp;</td>
								<td>缩略图</td>
								<td>{:L('FILE_NAME')}</td>
								<td>{:L('SIZE')}</td>
								<td>{:L('ADD_TIME')}</td>
								<td>{:L('ADDED_BY')}</td>
							</tr>
							<volist name="staff.file" id="vo">
								<tr>
									<td><a href="{:U('file/delete','r=RFileStaff&id=' . $vo['file_id'])}">{:L('DELETE')}</a>
										<a href="javascript:;" class="opener" data="{$vo.name}" data-id="{$vo.file_id}">{:L('EDIT')}</a></td>
									<td >
										<a href="{$vo.file_path}" target="_blank">
											<div class="screenshot" style="background:url({$vo.file_path}); background-size:cover;"></div>
										</a>
									</td>
									<td>
										<a target="_blank" href="{$vo.file_path}">{$vo.name}</a>
									</td>
									<td>
										{$vo.size}{:L('BYTE')}
									</td>
									<td>
										<notempty name="vo.create_date">{$vo.create_date|date="Y-m-d H:i:s",###}</notempty>
									</td>
									<td>
										<notempty name="vo.owner.user_name">{$vo.owner.user_name} [{$vo.owner.department_name}-{$vo.owner.role_name}]</notempty>
									</td>
								</tr>
							</volist>
						</if>
						<tr>
							<td colspan="5">
								<a href="javascript:void(0);" class="add_file">{:L('ADD')}</a>
							</td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="hide" id="dialog-file" title="{:L('DIALOG_ADD_ATTACHMENTS')}">loading...</div>
<div class="hide" id="dialog-log" title="{:L('DIALOG_ADD_LOG')}">loading...</div>
<div id="dialog" title="文件名修改">
	<form method="post" action="{:U('customer/editFileName')}">
		<input type="hidden" name="file_id" id="file_id" value=""/>
		文件名：<input name="name" id="file_name" value=""/>
		<input type="submit" value="确定"/>
	</form>
</div>
<script type="text/javascript">
<if condition="C('ismobile') eq 1">width=$('.container').width() * 0.9;<else/>width=800;</if>
$("#dialog-file").dialog({
    autoOpen: false,
    modal: true,
	width: width,
	maxHeigh: 400,
	position: ["center",100]
});
$("#dialog-log").dialog({
    autoOpen: false,
    modal: true,
	width: width,
	maxHeigh: 400,
	position: ["center",100]
});
$(".add_file").click(function(){
	$('#dialog-file').dialog('open');
	$('#dialog-file').load('{:U("file/add","r=RFileStaff&module=staff&id=" . $staff["id"])}');
});
//$(".add_log").click(function(){
//	$('#dialog-log').dialog('open');
//	$('#dialog-log').load('{:U("log/add","r=RLogUser&module=user&id=" . $staff["id"])}');
//});
$( "#dialog" ).dialog({
    autoOpen: false,
    show: {
        effect: "blind",
        duration: 10
    },
    hide: {
        effect: "explode",
        duration: 10
    }
});
$( ".opener" ).click(function() {
    $("#dialog").dialog( "open" );
    $('#file_name').val($(this).attr('data'));
    $('#file_id').val($(this).attr('data-id'));
});
</script>
<include file="Public:footer" />	